<div class="container">
  <h2>Rutas y Mapa</h2>

  <div class="content-wrapper">
    <div id="container-mapa" #containerMapa>
      <div id="map" #mapEl></div>
    </div>

    <div class="rutas-lista">
      <h3>Crear trazo</h3>

      <div class="draw-controls">
        <label>Nombre: <input type="text" [(ngModel)]="newRutaName"></label>
        <label>Color:
          <input type="color" [(ngModel)]="newRutaColor" [value]="newRutaColor || '#ff0000'">
        </label>
        <p>Usa la herramienta de dibujo en el mapa (ícono de línea) para trazar. Después haz Guardar.</p>

        <button (click)="saveDrawnRuta()" [disabled]="!lastGeo || saving">
          {{ saving ? 'Guardando...' : 'Guardar trazo' }}
        </button>
        <button (click)="cancelDraw()" [disabled]="!lastGeo">Cancelar trazo</button>
        <button class="boton" (click)="gotoVehiculos()">Ver Vehiculos</button>
      </div>

      <h3 style="margin-top:16px;">Rutas</h3>

      <div class="custom-select">
        <div class="select-toggle" (click)="toggleRutaList()" [attr.aria-expanded]="rutaListOpen">
          <span class="select-label">{{ selectedRutaLabel || '-- Selecciona una ruta --' }}</span>
          <span class="chev">▾</span>
        </div>

        <ul class="select-list" *ngIf="rutaListOpen">
          <li *ngFor="let ruta of rutas" class="select-item" (click)="selectRuta(ruta)">
            <span class="color-dot" [style.background]="ruta.color_hex || '#cbd5e1'"></span>
            <span class="item-text">{{ ruta.nombre_ruta }}</span>
            <span class="item-hex" *ngIf="ruta.color_hex">{{ ruta.color_hex }}</span>
          </li>
        </ul>
      </div>

      <h3 style="margin-top:16px;">Calles</h3>

      <div class="custom-select">
        <div class="select-toggle" (click)="toggleCalleList()" [attr.aria-expanded]="calleListOpen">
          <span class="select-label">{{ selectedCalleLabel || '-- Selecciona una calle --' }}</span>
          <span class="chev">▾</span>
        </div>

        <ul class="select-list" *ngIf="calleListOpen">
          <li *ngFor="let calle of calles" class="select-item" (click)="selectCalle(calle)">
            <span class="item-text">{{ calle.nombre }}</span>
            <span class="item-sub">{{ calle.id }}</span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>